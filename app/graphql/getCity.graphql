fragment CityOlympiad on Olympiad {
  id
  year
  olympiadType
}

fragment CityFields on City {
  id
  name
  slug
  firstOlympiad
  country {
    name
    flagByTimestamp(
      dateTimestamp: { start: { value: $now, inclusive: true }, end: { value: $now, inclusive: true } }
    ) {
      png
    }
  }
  olympiads(orderBy: YEAR_ASC) {
    nodes {
      ...CityOlympiad
    }
  }
}

query GetCity($slug: String!, $now: Datetime!) {
  cityBySlug(slug: $slug) {
    id
    name
    slug
    country {
      name
      flagByTimestamp(
        dateTimestamp: { start: { value: $now, inclusive: true }, end: { value: $now, inclusive: true } }
      ) {
        png
      }
    }
    olympiads(orderBy: YEAR_ASC) {
      nodes {
        ...CityOlympiad
      }
    }
  }
}

query GetCities($now: Datetime!) {
  cities {
    nodes {
      ...CityFields
    }
  }
}